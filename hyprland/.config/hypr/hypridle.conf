general {
    # avoid starting multiple hyprlock instances.
    # check if one is running using pidof
    lock_cmd = pidof hyprlock || ~/auto-scripts/hyprlock-immediately-reload.sh
    before_sleep_cmd = loginctl lock-session    # lock before suspend.
    after_sleep_cmd = hyprctl dispatch dpms on  # to avoid having to press a key twice to turn on the display.
}

listener {
    timeout = 150                                # 2.5min.
    on-timeout = brightnessctl -s set 10         # set monitor backlight to minimum, avoid 0 on OLED monitor.
    on-resume = brightnessctl -r                 # monitor backlight restore.
}

# turn off keyboard backlight
listener {
    timeout = 150                                          # 2.5min.
    on-timeout = brightnessctl -sd rgb:kbd_backlight set 0 # turn off keyboard backlight.
    on-resume = brightnessctl -rd rgb:kbd_backlight        # turn on keyboard backlight.
}

listener {
    timeout = 360                                 # 5min
    on-timeout = loginctl lock-session            # lock screen when timeout has passed
}


listener {
    timeout = 300                                 # 5min
    on-timeout = loginctl lock-session            # lock screen when timeout has passed
}


# TODO: Right now, even if music is paused in the user session, upon waking from sleep it goes into hyprlock and immediately starts playing music. It pauses again (restores state) when logging in though.

listener {
    timeout = 600                                 # 10min
# screen off when timeout has passed, except if playing music.
    on-timeout = if ! mpc status | grep playing; then  hyprctl dispatch dpms off; fi;
    on-resume = hyprctl dispatch dpms on          # screen on when activity is detected after timeout has fired.
}


listener {
    timeout = 1800                                # 30min
    on-timeout = systemctl suspend                # suspend pc
# Don't go to sleep if playing music
    on-timeout = if ! mpc status | grep playing; then  systemctl suspend; fi;
}
